<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-operations/crypto-forensics-recovery/forensics-sop" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">取证操作流程 (SOP) | Stars Labs IT 基础架构设计文档</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://stars-labs.github.io/full-it-infra-design-docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://stars-labs.github.io/full-it-infra-design-docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://stars-labs.github.io/full-it-infra-design-docs/docs/operations/crypto-forensics-recovery/forensics-sop"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="取证操作流程 (SOP) | Stars Labs IT 基础架构设计文档"><meta data-rh="true" name="description" content="本节提供从设备接收到最终销毁的完整标准操作流程。"><meta data-rh="true" property="og:description" content="本节提供从设备接收到最终销毁的完整标准操作流程。"><link data-rh="true" rel="icon" href="/full-it-infra-design-docs/img/favicon.png"><link data-rh="true" rel="canonical" href="https://stars-labs.github.io/full-it-infra-design-docs/docs/operations/crypto-forensics-recovery/forensics-sop"><link data-rh="true" rel="alternate" href="https://stars-labs.github.io/full-it-infra-design-docs/docs/operations/crypto-forensics-recovery/forensics-sop" hreflang="en"><link data-rh="true" rel="alternate" href="https://stars-labs.github.io/full-it-infra-design-docs/docs/operations/crypto-forensics-recovery/forensics-sop" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"运维与交付","item":"https://stars-labs.github.io/full-it-infra-design-docs/docs/category/运维与交付"},{"@type":"ListItem","position":2,"name":"加密资产取证与数据恢复","item":"https://stars-labs.github.io/full-it-infra-design-docs/docs/category/加密资产取证与数据恢复"},{"@type":"ListItem","position":3,"name":"取证操作流程 (SOP)","item":"https://stars-labs.github.io/full-it-infra-design-docs/docs/operations/crypto-forensics-recovery/forensics-sop"}]}</script><link rel="stylesheet" href="/full-it-infra-design-docs/assets/css/styles.a738df8a.css">
<script src="/full-it-infra-design-docs/assets/js/runtime~main.ddffb02d.js" defer="defer"></script>
<script src="/full-it-infra-design-docs/assets/js/main.55badd50.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/full-it-infra-design-docs/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/full-it-infra-design-docs/"><div class="navbar__logo"><img src="/full-it-infra-design-docs/img/logo.svg" alt="Stars Labs Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/full-it-infra-design-docs/img/logo.svg" alt="Stars Labs Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Stars Labs IT 架构</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/full-it-infra-design-docs/docs/category/核心设计">文档</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/stars-labs/full-it-infra-design-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/full-it-infra-design-docs/docs/category/核心设计"><span title="核心设计" class="categoryLinkLabel_W154">核心设计</span></a><button aria-label="Expand sidebar category &#x27;核心设计&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/full-it-infra-design-docs/docs/intro"><span title="项目简介" class="linkLabel_WmDU">项目简介</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/full-it-infra-design-docs/docs/category/硬件选型"><span title="硬件选型" class="categoryLinkLabel_W154">硬件选型</span></a><button aria-label="Expand sidebar category &#x27;硬件选型&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/full-it-infra-design-docs/docs/category/架构方案"><span title="架构方案" class="categoryLinkLabel_W154">架构方案</span></a><button aria-label="Expand sidebar category &#x27;架构方案&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/full-it-infra-design-docs/docs/category/it-治理制度"><span title="IT 治理制度" class="categoryLinkLabel_W154">IT 治理制度</span></a><button aria-label="Expand sidebar category &#x27;IT 治理制度&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/full-it-infra-design-docs/docs/category/运维与交付"><span title="运维与交付" class="categoryLinkLabel_W154">运维与交付</span></a><button aria-label="Collapse sidebar category &#x27;运维与交付&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/full-it-infra-design-docs/docs/operations/soe-standard"><span title="桌面终端标准化规范 (SOE)" class="linkLabel_WmDU">桌面终端标准化规范 (SOE)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/full-it-infra-design-docs/docs/operations/it-support-sla"><span title="IT 服务支持与 SLA 标准" class="linkLabel_WmDU">IT 服务支持与 SLA 标准</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/full-it-infra-design-docs/docs/category/加密资产取证与数据恢复"><span title="加密资产取证与数据恢复" class="categoryLinkLabel_W154">加密资产取证与数据恢复</span></a><button aria-label="Collapse sidebar category &#x27;加密资产取证与数据恢复&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/full-it-infra-design-docs/docs/operations/crypto-forensics-recovery/"><span title="加密资产取证与数据恢复" class="linkLabel_WmDU">加密资产取证与数据恢复</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/full-it-infra-design-docs/docs/operations/crypto-forensics-recovery/toolkit"><span title="取证工作站工具栈" class="linkLabel_WmDU">取证工作站工具栈</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/full-it-infra-design-docs/docs/operations/crypto-forensics-recovery/target-patterns"><span title="目标文件与特征" class="linkLabel_WmDU">目标文件与特征</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/full-it-infra-design-docs/docs/operations/crypto-forensics-recovery/forensics-sop"><span title="取证操作流程 (SOP)" class="linkLabel_WmDU">取证操作流程 (SOP)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/full-it-infra-design-docs/docs/operations/crypto-forensics-recovery/security-compliance"><span title="安全与合规要求" class="linkLabel_WmDU">安全与合规要求</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/full-it-infra-design-docs/docs/operations/filesystem-snapshot-rollback"><span title="文件系统快照与升级回滚 SOP" class="linkLabel_WmDU">文件系统快照与升级回滚 SOP</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/full-it-infra-design-docs/docs/contribution-guide"><span title="投稿与贡献指南" class="linkLabel_WmDU">投稿与贡献指南</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/full-it-infra-design-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/full-it-infra-design-docs/docs/category/运维与交付"><span>运维与交付</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/full-it-infra-design-docs/docs/category/加密资产取证与数据恢复"><span>加密资产取证与数据恢复</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">取证操作流程 (SOP)</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>取证操作流程 (SOP)</h1></header>
<p>本节提供从设备接收到最终销毁的完整标准操作流程。</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="流程概览">流程概览<a href="#流程概览" class="hash-link" aria-label="Direct link to 流程概览" title="Direct link to 流程概览" translate="no">​</a></h2>
<!-- -->
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-设备接收与登记">1. 设备接收与登记<a href="#1-设备接收与登记" class="hash-link" aria-label="Direct link to 1. 设备接收与登记" title="Direct link to 1. 设备接收与登记" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="11-接收检查清单">1.1 接收检查清单<a href="#11-接收检查清单" class="hash-link" aria-label="Direct link to 1.1 接收检查清单" title="Direct link to 1.1 接收检查清单" translate="no">​</a></h3>
<table><thead><tr><th style="text-align:left">检查项</th><th style="text-align:left">操作</th><th style="text-align:left">备注</th></tr></thead><tbody><tr><td style="text-align:left">设备标签</td><td style="text-align:left">核对资产编号</td><td style="text-align:left">与资产管理系统比对</td></tr><tr><td style="text-align:left">外观检查</td><td style="text-align:left">拍照记录物理状态</td><td style="text-align:left">包括屏幕、接口、外壳</td></tr><tr><td style="text-align:left">硬盘信息</td><td style="text-align:left">记录品牌、型号、容量</td><td style="text-align:left">填写《取证接收单》</td></tr><tr><td style="text-align:left">启动测试</td><td style="text-align:left">尝试开机判断硬盘状态</td><td style="text-align:left">如无法启动需备注</td></tr><tr><td style="text-align:left">人员签字</td><td style="text-align:left">双方签字确认</td><td style="text-align:left">保留证据链完整性</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="12-登记信息模板">1.2 登记信息模板<a href="#12-登记信息模板" class="hash-link" aria-label="Direct link to 1.2 登记信息模板" title="Direct link to 1.2 登记信息模板" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">取证接收单</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">案件编号: CASE-2024-001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">接收日期: 2024-02-03</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">接收人员: [IT工程师姓名]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">设备类型: [笔记本/台式机/移动硬盘]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">设备型号: [品牌型号]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">硬盘型号: [例如: Samsung 870 EVO 1TB]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">硬盘序列号: [S/N]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">硬盘容量: [GB/TB]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">硬盘接口: [SATA/NVMe/USB]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">设备状态: [正常/无法启动/物理损坏]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">原使用人: [员工姓名/工号]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">取证原因: [离职回收/故障抢救/审计需求]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">预估价值: [如已知]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">双人签字: [签字区]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=====================================</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="13-环境准备">1.3 环境准备<a href="#13-环境准备" class="hash-link" aria-label="Direct link to 1.3 环境准备" title="Direct link to 1.3 环境准备" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 创建案件目录结构</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CASE_ID=&quot;CASE-$(date +%Y%m%d)-$(printf &#x27;%03d&#x27; $((RANDOM % 1000)))&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BASE_DIR=&quot;/forensics/cases/$CASE_ID&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo mkdir -p &quot;$BASE_DIR&quot;/{raw,images,recovered,logs,reports,evidence}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown -R $USER:$USER &quot;$BASE_DIR&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 目录说明</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># raw/        - 原始证据文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># images/     - 法证镜像文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># recovered/  - 恢复的文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># logs/       - 操作日志</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># reports/    - 分析报告</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># evidence/   - 发现的加密资产证据</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-硬盘健康评估">2. 硬盘健康评估<a href="#2-硬盘健康评估" class="hash-link" aria-label="Direct link to 2. 硬盘健康评估" title="Direct link to 2. 硬盘健康评估" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="21-smart-检测流程">2.1 S.M.A.R.T. 检测流程<a href="#21-smart-检测流程" class="hash-link" aria-label="Direct link to 2.1 S.M.A.R.T. 检测流程" title="Direct link to 2.1 S.M.A.R.T. 检测流程" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 1. 识别目标磁盘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lsblk -f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo fdisk -l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 假设目标磁盘为 /dev/sdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TARGET_DISK=&quot;/dev/sdb&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2. 运行 S.M.A.R.T. 全面检测</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;=== 步骤 1: 基础信息 ===&quot; &gt; &quot;$BASE_DIR/logs/smart_report.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo smartctl -i &quot;$TARGET_DISK&quot; &gt;&gt; &quot;$BASE_DIR/logs/smart_report.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;&quot; &gt;&gt; &quot;$BASE_DIR/logs/smart_report.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;=== 步骤 2: 完整报告 ===&quot; &gt;&gt; &quot;$BASE_DIR/logs/smart_report.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo smartctl -a &quot;$TARGET_DISK&quot; &gt;&gt; &quot;$BASE_DIR/logs/smart_report.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;&quot; &gt;&gt; &quot;$BASE_DIR/logs/smart_report.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;=== 步骤 3: 健康评估 ===&quot; &gt;&gt; &quot;$BASE_DIR/logs/smart_report.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo smartctl -H &quot;$TARGET_DISK&quot; &gt;&gt; &quot;$BASE_DIR/logs/smart_report.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 3. 运行短期自检 (可选)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo smartctl -t short &quot;$TARGET_DISK&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;短期自检已启动，约 2 分钟完成...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sleep 120</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo smartctl -l selftest &quot;$TARGET_DISK&quot; &gt;&gt; &quot;$BASE_DIR/logs/smart_report.txt&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="22-评估决策树">2.2 评估决策树<a href="#22-评估决策树" class="hash-link" aria-label="Direct link to 2.2 评估决策树" title="Direct link to 2.2 评估决策树" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">S.M.A.R.T. 状态评估:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─ PASSED (通过)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─ 可尝试直接挂载只读分析</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     └─ 挂载成功 → 直接进入分析阶段</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     └─ 挂载失败 → 创建法证镜像</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─ WARNING (警告)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─ 必须创建法证镜像，禁止直接挂载</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     └─ 镜像成功 → 分析镜像</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     └─ 镜像失败 → 专业数据恢复公司</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─ FAILED (失败)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   └─ 立即停止操作</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      └─ 建议送专业数据恢复服务</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="23-健康指标决策表">2.3 健康指标决策表<a href="#23-健康指标决策表" class="hash-link" aria-label="Direct link to 2.3 健康指标决策表" title="Direct link to 2.3 健康指标决策表" translate="no">​</a></h3>
<table><thead><tr><th style="text-align:left">指标</th><th style="text-align:left">正常</th><th style="text-align:left">警告</th><th style="text-align:left">危险</th></tr></thead><tbody><tr><td style="text-align:left">Reallocated_Sector_Ct</td><td style="text-align:left">0</td><td style="text-align:left">1-10</td><td style="text-align:left">&gt; 10</td></tr><tr><td style="text-align:left">Current_Pending_Sector</td><td style="text-align:left">0</td><td style="text-align:left">1-5</td><td style="text-align:left">&gt; 5</td></tr><tr><td style="text-align:left">Offline_Uncorrectable</td><td style="text-align:left">0</td><td style="text-align:left">1-2</td><td style="text-align:left">&gt; 2</td></tr><tr><td style="text-align:left">Temperature</td><td style="text-align:left">&lt; 45°C</td><td style="text-align:left">45-55°C</td><td style="text-align:left">&gt; 55°C</td></tr><tr><td style="text-align:left">Power_On_Hours</td><td style="text-align:left">&lt; 30,000h</td><td style="text-align:left">30,000-50,000h</td><td style="text-align:left">&gt; 50,000h</td></tr><tr><td style="text-align:left">Seek_Error_Rate</td><td style="text-align:left">0</td><td style="text-align:left">&lt; 10</td><td style="text-align:left">&gt; 10</td></tr></tbody></table>
<p><strong>决策规则</strong>:</p>
<ul>
<li class="">所有指标正常 → 绿色，可直接操作</li>
<li class="">1-2 个警告 → 黄色，必须创建镜像</li>
<li class="">任何危险或多个警告 → 红色，停止操作送专业机构</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-创建法证镜像">3. 创建法证镜像<a href="#3-创建法证镜像" class="hash-link" aria-label="Direct link to 3. 创建法证镜像" title="Direct link to 3. 创建法证镜像" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="31-使用-ddrescue-创建镜像">3.1 使用 ddrescue 创建镜像<a href="#31-使用-ddrescue-创建镜像" class="hash-link" aria-label="Direct link to 3.1 使用 ddrescue 创建镜像" title="Direct link to 3.1 使用 ddrescue 创建镜像" translate="no">​</a></h3>
<p><strong>核心原则</strong>: 对任何非全新硬盘，优先创建镜像再分析。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 变量设置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SOURCE_DISK=&quot;/dev/sdb&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IMAGE_FILE=&quot;$BASE_DIR/images/disk.img&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MAP_FILE=&quot;$BASE_DIR/logs/ddrescue.map&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LOG_FILE=&quot;$BASE_DIR/logs/ddrescue.log&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 步骤 1: 第一阶段 - 快速读取 (跳过损坏扇区)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;[$(date)] 开始第一阶段: 快速读取&quot; &gt;&gt; &quot;$LOG_FILE&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo ddrescue -n -v &quot;$SOURCE_DISK&quot; &quot;$IMAGE_FILE&quot; &quot;$MAP_FILE&quot; 2&gt;&amp;1 | tee -a &quot;$LOG_FILE&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 步骤 2: 第二阶段 - 深度恢复</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;[$(date)] 开始第二阶段: 深度恢复&quot; &gt;&gt; &quot;$LOG_FILE&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo ddrescue -d -r3 -v &quot;$SOURCE_DISK&quot; &quot;$IMAGE_FILE&quot; &quot;$MAP_FILE&quot; 2&gt;&amp;1 | tee -a &quot;$LOG_FILE&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 步骤 3: 验证镜像完整性</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;[$(date)] 计算校验和&quot; &gt;&gt; &quot;$LOG_FILE&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sha256sum &quot;$IMAGE_FILE&quot; &gt; &quot;$BASE_DIR/logs/disk.img.sha256&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">md5sum &quot;$IMAGE_FILE&quot; &gt; &quot;$BASE_DIR/logs/disk.img.md5&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;[$(date)] 镜像创建完成&quot; &gt;&gt; &quot;$LOG_FILE&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls -lh &quot;$IMAGE_FILE&quot; &gt;&gt; &quot;$LOG_FILE&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="32-ddrescue-进度监控">3.2 ddrescue 进度监控<a href="#32-ddrescue-进度监控" class="hash-link" aria-label="Direct link to 3.2 ddrescue 进度监控" title="Direct link to 3.2 ddrescue 进度监控" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 在另一个终端查看进度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">watch -n 5 &#x27;cat /forensics/cases/*/logs/ddrescue.map | tail -20&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 或使用 mapfile 查看状态</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ddrescue -v /dev/null /dev/null /forensics/cases/*/logs/ddrescue.map</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="33-镜像验证">3.3 镜像验证<a href="#33-镜像验证" class="hash-link" aria-label="Direct link to 3.3 镜像验证" title="Direct link to 3.3 镜像验证" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 验证镜像文件系统</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fsstat &quot;$IMAGE_FILE&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 对比原始磁盘和镜像的校验和 (前 1GB)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sha256sum &lt;(sudo dd if=&quot;$SOURCE_DISK&quot; bs=1M count=1024) \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &lt;(dd if=&quot;$IMAGE_FILE&quot; bs=1M count=1024)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-挂载与初步分析">4. 挂载与初步分析<a href="#4-挂载与初步分析" class="hash-link" aria-label="Direct link to 4. 挂载与初步分析" title="Direct link to 4. 挂载与初步分析" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="41-只读挂载操作">4.1 只读挂载操作<a href="#41-只读挂载操作" class="hash-link" aria-label="Direct link to 4.1 只读挂载操作" title="Direct link to 4.1 只读挂载操作" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 场景 1: 直接挂载物理磁盘 (仅当 S.M.A.R.T. 完全正常)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo mkdir -p /mnt/physical_evidence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo mount -o ro,noload &quot;$SOURCE_DISK&quot;1 /mnt/physical_evidence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 场景 2: 挂载法证镜像</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">case_image=&quot;$BASE_DIR/images/disk.img&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo mkdir -p /mnt/image_evidence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 识别分区偏移</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo fdisk -l &quot;$case_image&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 计算偏移量 (假设从第 2048 扇区开始，每扇区 512 字节)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">offset=$((512 * 2048))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 挂载分区</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo mount -o ro,loop,offset=$offset &quot;$case_image&quot; /mnt/image_evidence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 或者使用 kpartx 自动识别分区</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install kpartx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo kpartx -v -a &quot;$case_image&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 会创建 /dev/mapper/loopXpY 设备</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo mount -o ro /dev/mapper/loop0p1 /mnt/image_evidence</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="42-ntfs-特殊处理">4.2 NTFS 特殊处理<a href="#42-ntfs-特殊处理" class="hash-link" aria-label="Direct link to 4.2 NTFS 特殊处理" title="Direct link to 4.2 NTFS 特殊处理" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Windows 系统通常使用 NTFS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo mkdir -p /mnt/ntfs_evidence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 只读挂载 NTFS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo mount -t ntfs-3g -o ro,remove_hiberfile,recover \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdb1 /mnt/ntfs_evidence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果遇到休眠文件错误</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo ntfsfix -n /dev/sdb1  # 检查 (dry-run)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="43-卸载与清理">4.3 卸载与清理<a href="#43-卸载与清理" class="hash-link" aria-label="Direct link to 4.3 卸载与清理" title="Direct link to 4.3 卸载与清理" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 安全卸载</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo umount /mnt/image_evidence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果使用 kpartx，删除映射</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo kpartx -d &quot;$case_image&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 验证卸载</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount | grep evidence  # 应该无输出</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="5-深度文件系统分析">5. 深度文件系统分析<a href="#5-深度文件系统分析" class="hash-link" aria-label="Direct link to 5. 深度文件系统分析" title="Direct link to 5. 深度文件系统分析" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="51-sleuth-kit-分析流程">5.1 Sleuth Kit 分析流程<a href="#51-sleuth-kit-分析流程" class="hash-link" aria-label="Direct link to 5.1 Sleuth Kit 分析流程" title="Direct link to 5.1 Sleuth Kit 分析流程" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd &quot;$BASE_DIR&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">image=&quot;images/disk.img&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 步骤 1: 识别文件系统</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;=== 文件系统信息 ===&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fsstat &quot;$image&quot; | tee reports/filesystem_info.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 步骤 2: 列出分区结构</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;=== 分区结构 ===&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fls &quot;$image&quot; | tee reports/partition_structure.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 步骤 3: 递归列出所有文件 (包括已删除)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;=== 完整文件列表 ===&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fls -r -p &quot;$image&quot; | tee reports/all_files.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 步骤 4: 搜索钱包相关文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;=== 钱包文件搜索 ===&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fls -r &quot;$image&quot; | grep -iE &quot;wallet|bitcoin|ethereum|keystore|mnemonic|seed&quot; | \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tee reports/wallet_files.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 步骤 5: 恢复已删除文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p recovered</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fls -r -d &quot;$image&quot;  # 列出已删除文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 步骤 6: 提取可疑文件 (根据 inode 号)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 示例: icat image.img 12345 &gt; recovered/file_from_inode_12345.bin</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="52-时间线分析">5.2 时间线分析<a href="#52-时间线分析" class="hash-link" aria-label="Direct link to 5.2 时间线分析" title="Direct link to 5.2 时间线分析" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 生成文件时间线</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fls -r -m / &quot;$image&quot; &gt; reports/timeline_bodyfile.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 使用 mactime 分析 (需安装 sleuthkit 工具包)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mactime -b reports/timeline_bodyfile.txt -d &gt; reports/timeline.csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 查看最近访问的文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">head -100 reports/timeline.csv</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="6-关键词搜索与模式匹配">6. 关键词搜索与模式匹配<a href="#6-关键词搜索与模式匹配" class="hash-link" aria-label="Direct link to 6. 关键词搜索与模式匹配" title="Direct link to 6. 关键词搜索与模式匹配" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="61-助记词搜索">6.1 助记词搜索<a href="#61-助记词搜索" class="hash-link" aria-label="Direct link to 6.1 助记词搜索" title="Direct link to 6.1 助记词搜索" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 定义 BIP-39 前 100 个高频词</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BIP39_WORDS=&quot;abandon|ability|able|about|above|absent|absorb|abstract|absurd|abuse|access|accident|account|accuse|achieve|acid|acoustic|acquire|across|act|action|actor|actual|adapt|add|addict|address|adjust|admit|adult|advance|advice|aerobic|affair|afford|afraid|again|age|agent|agree|ahead|aim|air|airport|aisle|alarm|album|alcohol|alert|alien|all|alley|allow|almost|alone|alpha|already|also|alter|always|amateur|amazing|among|amount|amused|anchor|ancient|anger|angle|angry|animal|ankle|announce|annual|another|answer|antenna|antique|anxiety|any|apart|apology|appear|apple|approve|april|arch|arctic|area|arena|argue|armed|armor|army|around|arrange|arrest|arrive|arrow|art|artefact|artist|artwork&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 搜索文本文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;=== 搜索助记词模式 ===&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rg -i &quot;\b($BIP39_WORDS)\b&quot; /mnt/image_evidence/ \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --type txt --type md --type json 2&gt;/dev/null | \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tee reports/mnemonic_matches.txt</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="62-私钥与密钥搜索">6.2 私钥与密钥搜索<a href="#62-私钥与密钥搜索" class="hash-link" aria-label="Direct link to 6.2 私钥与密钥搜索" title="Direct link to 6.2 私钥与密钥搜索" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 搜索十六进制私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;=== 搜索十六进制私钥 ===&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rg -i &#x27;\b[0-9a-fA-F]{64}\b&#x27; /mnt/image_evidence/ \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --type txt 2&gt;/dev/null | tee reports/hex_keys.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 搜索 WIF 格式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;=== 搜索 WIF 格式 ===&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rg -i &#x27;\b[5KL][1-9A-HJ-NP-Za-km-z]{50,51}\b&#x27; /mnt/image_evidence/ \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --type txt 2&gt;/dev/null | tee reports/wif_keys.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 搜索 Keystore JSON</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;=== 搜索 Keystore 文件 ===&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rg -i &#x27;&quot;crypto&quot;.*&quot;ciphertext&quot;.*&quot;kdf&quot;&#x27; /mnt/image_evidence/ \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --type json --type txt 2&gt;/dev/null | tee reports/keystore_files.txt</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="63-压缩包处理">6.3 压缩包处理<a href="#63-压缩包处理" class="hash-link" aria-label="Direct link to 6.3 压缩包处理" title="Direct link to 6.3 压缩包处理" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 找到所有压缩包</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find /mnt/image_evidence/ -type f \( \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -name &quot;*.zip&quot; -o -name &quot;*.7z&quot; -o -name &quot;*.rar&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -o -name &quot;*.tar.gz&quot; -o -name &quot;*.tar.bz2&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) 2&gt;/dev/null | tee reports/archives.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 解压并搜索 (创建临时目录)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p temp_extract</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">while read -r archive; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;Processing: $archive&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    7z x &quot;$archive&quot; -o&quot;temp_extract/$(basename &quot;$archive&quot;)&quot; -p&quot;&quot; 2&gt;/dev/null || true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 注意: 加密压缩包会失败，需记录待后续处理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done &lt; reports/archives.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在解压后的文件中搜索</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rg -i &quot;wallet|bitcoin|ethereum|crypto&quot; temp_extract/ 2&gt;/dev/null | \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tee reports/archive_contents.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 清理临时文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rm -rf temp_extract</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="7-photorec-深度恢复">7. PhotoRec 深度恢复<a href="#7-photorec-深度恢复" class="hash-link" aria-label="Direct link to 7. PhotoRec 深度恢复" title="Direct link to 7. PhotoRec 深度恢复" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="71-文件雕刻恢复">7.1 文件雕刻恢复<a href="#71-文件雕刻恢复" class="hash-link" aria-label="Direct link to 7.1 文件雕刻恢复" title="Direct link to 7.1 文件雕刻恢复" translate="no">​</a></h3>
<p>当文件系统严重损坏或文件被删除时，使用 PhotoRec 进行块级恢复。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 启动 PhotoRec 交互式界面</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo photorec &quot;$BASE_DIR/images/disk.img&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># PhotoRec 交互步骤:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 1. 选择磁盘/镜像</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2. 选择分区 (或选择 [Whole disk])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 3. 选择文件系统类型 ([Other] 适用于通用扫描)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 4. 选择恢复位置: &quot;$BASE_DIR/recovered&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 5. 选择文件类型 (按空格键选择):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#    - [X] txt (文本文件 - 可能包含助记词)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#    - [X] json (Keystore 文件)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#    - [X] docx/xlsx (Office 文档)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#    - [X] jpg/png (截图)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 6. 按 [C] 开始恢复</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="72-批量整理恢复结果">7.2 批量整理恢复结果<a href="#72-批量整理恢复结果" class="hash-link" aria-label="Direct link to 7.2 批量整理恢复结果" title="Direct link to 7.2 批量整理恢复结果" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># PhotoRec 恢复的文件按类型分类</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 整理到更清晰的目录结构</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd &quot;$BASE_DIR/recovered&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 按文件类型组织</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p {text,wallets,images,documents,other}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 移动文本文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find . -name &quot;*.txt&quot; -o -name &quot;*.md&quot; -o -name &quot;*.json&quot; 2&gt;/dev/null | \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    head -1000 | xargs -I {} mv {} text/ 2&gt;/dev/null || true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 移动图片</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find . -type f \( -name &quot;*.jpg&quot; -o -name &quot;*.jpeg&quot; -o -name &quot;*.png&quot; \) 2&gt;/dev/null | \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    head -1000 | xargs -I {} mv {} images/ 2&gt;/dev/null || true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 移动文档</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find . -type f \( -name &quot;*.doc&quot; -o -name &quot;*.docx&quot; -o -name &quot;*.pdf&quot; \) 2&gt;/dev/null | \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    head -1000 | xargs -I {} mv {} documents/ 2&gt;/dev/null || true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;恢复文件已整理完成&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tree -L 2 &quot;$BASE_DIR/recovered&quot; 2&gt;/dev/null || ls -R &quot;$BASE_DIR/recovered&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="8-结果整理与报告">8. 结果整理与报告<a href="#8-结果整理与报告" class="hash-link" aria-label="Direct link to 8. 结果整理与报告" title="Direct link to 8. 结果整理与报告" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="81-发现的资产分类">8.1 发现的资产分类<a href="#81-发现的资产分类" class="hash-link" aria-label="Direct link to 8.1 发现的资产分类" title="Direct link to 8.1 发现的资产分类" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 创建最终报告</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; &quot;$BASE_DIR/reports/FINAL_REPORT.txt&quot; &lt;&lt; &#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">加密资产取证报告</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">案件编号: $CASE_ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">取证日期: $(date)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">取证人员: [姓名]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">一、设备信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">设备类型: [笔记本/台式机/硬盘]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">硬盘型号: [型号]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">硬盘容量: [容量]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">硬盘健康: [SMART 结果]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">二、取证方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">镜像工具: ddrescue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">分析工具: Sleuth Kit, ripgrep, PhotoRec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">挂载方式: 只读挂载</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">三、发现结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 汇总所有发现</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;&quot; &gt;&gt; &quot;$BASE_DIR/reports/FINAL_REPORT.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;发现的钱包文件:&quot; &gt;&gt; &quot;$BASE_DIR/reports/FINAL_REPORT.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat reports/wallet_files.txt 2&gt;/dev/null &gt;&gt; &quot;$BASE_DIR/reports/FINAL_REPORT.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;&quot; &gt;&gt; &quot;$BASE_DIR/reports/FINAL_REPORT.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;发现的助记词匹配:&quot; &gt;&gt; &quot;$BASE_DIR/reports/FINAL_REPORT.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wc -l reports/mnemonic_matches.txt 2&gt;/dev/null &gt;&gt; &quot;$BASE_DIR/reports/FINAL_REPORT.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;&quot; &gt;&gt; &quot;$BASE_DIR/reports/FINAL_REPORT.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;恢复的已删除文件数:&quot; &gt;&gt; &quot;$BASE_DIR/reports/FINAL_REPORT.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find recovered/ -type f 2&gt;/dev/null | wc -l &gt;&gt; &quot;$BASE_DIR/reports/FINAL_REPORT.txt&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="82-证据打包">8.2 证据打包<a href="#82-证据打包" class="hash-link" aria-label="Direct link to 8.2 证据打包" title="Direct link to 8.2 证据打包" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 生成证据包哈希</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd &quot;$BASE_DIR&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find evidence/ -type f -exec sha256sum {} \; &gt; evidence/hashes.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打包整个案件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tar czf &quot;../${CASE_ID}_evidence.tar.gz&quot; .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 计算包哈希</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sha256sum &quot;../${CASE_ID}_evidence.tar.gz&quot; &gt; &quot;../${CASE_ID}_evidence.tar.gz.sha256&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;证据包已生成: ${CASE_ID}_evidence.tar.gz&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;校验和: $(cat ../${CASE_ID}_evidence.tar.gz.sha256)&quot;</span><br></span></code></pre></div></div>
<hr>
<p><strong>下一步</strong>: <a class="" href="/full-it-infra-design-docs/docs/operations/crypto-forensics-recovery/security-compliance">安全与合规</a> - 了解证据处理和合规要求</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/05-operations/crypto-forensics-recovery/03-forensics-sop.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/full-it-infra-design-docs/docs/operations/crypto-forensics-recovery/target-patterns"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">目标文件与特征</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/full-it-infra-design-docs/docs/operations/crypto-forensics-recovery/security-compliance"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">安全与合规要求</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#流程概览" class="table-of-contents__link toc-highlight">流程概览</a></li><li><a href="#1-设备接收与登记" class="table-of-contents__link toc-highlight">1. 设备接收与登记</a><ul><li><a href="#11-接收检查清单" class="table-of-contents__link toc-highlight">1.1 接收检查清单</a></li><li><a href="#12-登记信息模板" class="table-of-contents__link toc-highlight">1.2 登记信息模板</a></li><li><a href="#13-环境准备" class="table-of-contents__link toc-highlight">1.3 环境准备</a></li></ul></li><li><a href="#2-硬盘健康评估" class="table-of-contents__link toc-highlight">2. 硬盘健康评估</a><ul><li><a href="#21-smart-检测流程" class="table-of-contents__link toc-highlight">2.1 S.M.A.R.T. 检测流程</a></li><li><a href="#22-评估决策树" class="table-of-contents__link toc-highlight">2.2 评估决策树</a></li><li><a href="#23-健康指标决策表" class="table-of-contents__link toc-highlight">2.3 健康指标决策表</a></li></ul></li><li><a href="#3-创建法证镜像" class="table-of-contents__link toc-highlight">3. 创建法证镜像</a><ul><li><a href="#31-使用-ddrescue-创建镜像" class="table-of-contents__link toc-highlight">3.1 使用 ddrescue 创建镜像</a></li><li><a href="#32-ddrescue-进度监控" class="table-of-contents__link toc-highlight">3.2 ddrescue 进度监控</a></li><li><a href="#33-镜像验证" class="table-of-contents__link toc-highlight">3.3 镜像验证</a></li></ul></li><li><a href="#4-挂载与初步分析" class="table-of-contents__link toc-highlight">4. 挂载与初步分析</a><ul><li><a href="#41-只读挂载操作" class="table-of-contents__link toc-highlight">4.1 只读挂载操作</a></li><li><a href="#42-ntfs-特殊处理" class="table-of-contents__link toc-highlight">4.2 NTFS 特殊处理</a></li><li><a href="#43-卸载与清理" class="table-of-contents__link toc-highlight">4.3 卸载与清理</a></li></ul></li><li><a href="#5-深度文件系统分析" class="table-of-contents__link toc-highlight">5. 深度文件系统分析</a><ul><li><a href="#51-sleuth-kit-分析流程" class="table-of-contents__link toc-highlight">5.1 Sleuth Kit 分析流程</a></li><li><a href="#52-时间线分析" class="table-of-contents__link toc-highlight">5.2 时间线分析</a></li></ul></li><li><a href="#6-关键词搜索与模式匹配" class="table-of-contents__link toc-highlight">6. 关键词搜索与模式匹配</a><ul><li><a href="#61-助记词搜索" class="table-of-contents__link toc-highlight">6.1 助记词搜索</a></li><li><a href="#62-私钥与密钥搜索" class="table-of-contents__link toc-highlight">6.2 私钥与密钥搜索</a></li><li><a href="#63-压缩包处理" class="table-of-contents__link toc-highlight">6.3 压缩包处理</a></li></ul></li><li><a href="#7-photorec-深度恢复" class="table-of-contents__link toc-highlight">7. PhotoRec 深度恢复</a><ul><li><a href="#71-文件雕刻恢复" class="table-of-contents__link toc-highlight">7.1 文件雕刻恢复</a></li><li><a href="#72-批量整理恢复结果" class="table-of-contents__link toc-highlight">7.2 批量整理恢复结果</a></li></ul></li><li><a href="#8-结果整理与报告" class="table-of-contents__link toc-highlight">8. 结果整理与报告</a><ul><li><a href="#81-发现的资产分类" class="table-of-contents__link toc-highlight">8.1 发现的资产分类</a></li><li><a href="#82-证据打包" class="table-of-contents__link toc-highlight">8.2 证据打包</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/full-it-infra-design-docs/docs/intro">项目简介</a></li><li class="footer__item"><a class="footer__link-item" href="/full-it-infra-design-docs/docs/core-design/it-infra-design">IT 基础架构设计</a></li><li class="footer__item"><a class="footer__link-item" href="/full-it-infra-design-docs/docs/hardware/switch-selection">交换机选型</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">资源</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/stars-labs/full-it-infra-design-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Stars Labs. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>