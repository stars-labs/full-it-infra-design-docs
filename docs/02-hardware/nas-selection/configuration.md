---
sidebar_position: 5
---

# 系统部署与配置

## ZFS 配置建议

### RAID-Z 方案

| 盘位 | 推荐方案 | 可用容量 | 容错 |
|------|----------|----------|------|
| 5盘 | RAID-Z1 (4+1) | 80% | 1盘 |
| 6盘 | RAID-Z2 (4+2) | 67% | 2盘 |
| 8盘 | RAID-Z2 (6+2) | 75% | 2盘 |
| 10盘 | 2× RAID-Z1 (4+1) | 80% | 每组1盘 |

## MinIO 部署配置

### 硬盘配置建议

MinIO 推荐使用独立硬盘，不使用 RAID：

| 节点数 | 每节点硬盘数 | 总硬盘数 | 最小容量 | 推荐配置 |
|--------|-------------|----------|----------|----------|
| 4节点 | 6盘 | 24盘 | 4TB×24=96TB | 方案A |
| 8节点 | 8盘 | 64盘 | 8TB×64=512TB | 方案B |
| 16节点 | 8盘 | 128盘 | 8TB×128=1PB | 方案C |

### 网络配置

| 场景 | 网口配置 | 带宽 | 推荐方案 |
|------|----------|------|----------|
| 入门级 | 4×2.5GbE | 10Gbps | N305主板 |
| 标准级 | 1×10GbE + 2×2.5GbE | 15Gbps | N355主板 |
| 企业级 | 2×10GbE + 2×2.5GbE | 25Gbps | N355+万兆交换机 |

### 系统配置优化

```bash
# MinIO 推荐系统配置
# 1. 禁用 swap
swapoff -a

# 2. 设置文件描述符
echo "* soft nofile 65536" >> /etc/security/limits.conf
echo "* hard nofile 65536" >> /etc/security/limits.conf

# 3. 优化网络参数
echo "net.core.rmem_max = 134217728" >> /etc/sysctl.conf
echo "net.core.wmem_max = 134217728" >> /etc/sysctl.conf
echo "net.ipv4.tcp_rmem = 4096 87380 134217728" >> /etc/sysctl.conf
echo "net.ipv4.tcp_wmem = 4096 65536 134217728" >> /etc/sysctl.conf
```

## 验收测试

### 硬件检测

- [ ] CPU 温度正常（小于70°C）
- [ ] 内存识别完整
- [ ] 所有 SATA 接口识别
- [ ] 网口 Link 状态正常
- [ ] 热插拔功能测试

### MinIO 测试

- [ ] MinIO 集群部署成功
- [ ] 所有节点健康状态
- [ ] 读写性能测试通过
- [ ] 故障转移测试正常
- [ ] 数据一致性验证

### 性能基准

- [ ] 单节点吞吐量大于 200MB/s
- [ ] 集群总带宽接近网口带宽
- [ ] SMART 状态健康
- [ ] 7×24小时压力测试通过
